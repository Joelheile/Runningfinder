<a id="readme-top"></a>

<!-- PROJECT LOGO -->
<br />
<div align="center">
  <a href="https://github.com/Joelheile/ClubHub">
    <img src="/public/icons/App Icon.png" alt="Logo" width="80" height="80">
  </a>

  <h3 align="center">Running Finder</h3>

  <p align="center">
Tired of running alone? Got overwhelmed with all the running clubs?
<br /> We're here to help you. Find the running clubs of your dreams!
    <br />
   
</div>

<!-- TABLE OF CONTENTS -->
<details>
  <summary>Table of Contents</summary>
  <ol>
    <li>
      <a href="#about-the-project">About The Project</a>
      <ul>
        <li><a href="#built-with">Built With</a></li>
      </ul>
    </li>
    <li>
      <a href="#getting-started">Getting Started</a>
      <ul>
        <li><a href="#installation">Installation</a></li>
      </ul>
    </li>
    <li><a href="#entity-relationship-er-diagram">ER Model</a></li>
    <li><a href="#roadmap">Roadmap</a></li>
       <li><a href="#static-code-analysis">Static Code Analysis</a></li>
    <li><a href="#contributing">Contributing</a></li>
    <li><a href="#license">License</a></li>
    <li><a href="#contact">Contact</a></li>
    <li><a href="#acknowledgments">Acknowledgments</a></li>
  </ol>
</details>

<!-- ABOUT THE PROJECT -->

## About The Project

This semester, I started building **Running Finder** â€” a platform inspired by Berlin's growing community gathering trend.

The mission is to centralize information about running clubs, events and display them on a dynamic Google Map. Users can filter through runs based on their needs (distance, weekday, or difficulty). Clicking on the run marker, the user is redirected to the club, where the user gets all the information needed and can register for a run.

If a user is signed in, adding new runs or clubs is possible. Different authentication roles will be implemented in the future. Soon, managing runs and implementing recurring and single runs into the application will also be possible. Prioritizing recurring events was a strategic decision, as it saves space, and most running clubs are managed like this.

### Built With

- [![Next][Next.js]][Next-url]
- [![React][React.js]][React-url]
- [![Drizzle][Drizzle]][Drizzle-url]
- [![Jest][Jest]][Jest-url]
- ![TailwindCSS][TailwindCSS]
- [![Neon][Neon-tech]][Neon-tech-url]

[Drizzle]: https://img.shields.io/badge/Drizzle-000000?style=for-the-badge&logo=drizzle&logoColor=white
[Drizzle-url]: https://drizzle.team/
[Neon-tech]: https://img.shields.io/badge/Neon-000000?style=for-the-badge&logo=neon&logoColor=white
[Neon-tech-url]: https://neon.tech/
[Jest]: https://img.shields.io/badge/Jest-C21325?style=for-the-badge&logo=jest&logoColor=white
[Jest-url]: https://jestjs.io/

<p align="right">(<a href="#readme-top">back to top</a>)</p>

<!-- USE CASES -->

## Use cases

- Runs
  - are displayed on interactive map
  - users can register for runs
  - runs can be filtered by distance, weekday and difficulty
- Clubs
  - Discover: Get to know knew running clubs
  - Members: Join and leave clubs, view club details and runs
  - Admins: Add and manage club details and runs

## Data Generation

The data in the database is completely user generated and not generated by the backend.
This has the background that I'm currently testing the mvp with users and am using the production database for it.
One of the steps until the assessment is to implement also a local testing database with generated data.

<!-- GETTING STARTED -->

## Getting Started

Download node.js and install pnpm

- pnpm
  ```sh
  npm install pnpm
  ```

### Installation

_To skip the process of setting up different API Keys in Google and Github oAuth in this assessment, I've provided my env secrets to copy them into a .env.local file. <br> Please do not share them_

1. Clone the repo
   ```sh
   git clone https://github.com/Joelheile/ClubHub.git
   ```
2. Install packages
   ```sh
   pnpm i
   ```
3. Create .env.local file

   ```js
   NEXT_PUBLIC_GOOGLE_MAPS = "AIzaSyBbcMGc_p3x5QCI7VL6oWhwjOoRuK8bg1E";
    NEXT_PUBLIC_DATABASE_URL=postgresql://neondb_owner:uYHlKUV4O2dD@ep-autumn-leaf-a2sf0ajv.eu-central-1.aws.neon.tech/neondb?sslmode=require

    NEXT_PUBLIC_AWS_REGION=eu-central-1
    NEXT_PUBLIC_AWS_ACCESS_KEY_ID=AKIA272ZFXQ2WYDUSYMJ
    NEXT_PUBLIC_AWS_SECRET_ACCESS_KEY=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
    NEXT_PUBLIC_AWS_BUCKET_NAME=runningfinder
    NEXT_PUBLIC_AWS_HOSTNAME=runningfinder.s3.eu-central-1.amazonaws.com

    NEXT_PUBLIC_AUTH_RESEND_KEY=re_cuZuLfEn_AJKP36qoUnWrGktJUBqF6tT7

    AUTH_GITHUB_ID=Ov23liKJjCL6DL4YYt0I
    AUTH_GITHUB_SECRET=7242a21ade85ff72b0f495f9bc7b79148cf8106c

    AUTH_SECRET="QXk7UrfIiNGtVeZmRqoIs40pBSrVJ4lOuftPg8sOROI="
   ```

4. Run project
   ```sh
   pnpm run dev
   ```
5. Run tests
   ```sh
   pnpm run tests
   ```
6. Get familiar with [API documentation](http://localhost:3000/api-doc)
   ```sh
   http://localhost:3000/api-doc
   ```

<p align="right">(<a href="#readme-top">back to top</a>)</p>

<!-- <Flowchart> -->

### Entity-Relationship (ER) Diagram

```mermaid
erDiagram
    USERS {
        string id PK
        string name
        string email
        date emailVerified
        string bio
        date createdAt
        date updatedAt
        date lastLogin
        int attendedRuns
        string image
    }

    ACCOUNTS {
        string userId FK
        string type
        string provider
        string providerAccountId
        string refresh_token
        string access_token
        int expires_at
        string token_type
        string scope
        string id_token
        string session_state
    }
    ACCOUNTS ||--o| USERS : "userId"

    SESSIONS {
        string sessionToken PK
        string userId FK
        date expires
    }
    SESSIONS ||--o| USERS : "userId"


    AUTHENTICATORS {
        string credentialID
        string userId FK
        string providerAccountId
        string credentialPublicKey
        int counter
        string credentialDeviceType
        boolean credentialBackedUp
        string transports
    }
    AUTHENTICATORS ||--o| USERS : "userId"

    MEMBERSHIPS {
        string id PK
        string userId FK
        string clubId FK
        date joinDate
        statusEnum status
        roleEnum role
    }
    MEMBERSHIPS ||--o| USERS : "userId"
    MEMBERSHIPS ||--o| CLUBS : "clubId"

    CLUBS {
        string id PK
        string name
        string slug
        string description
        decimal locationLng
        decimal locationLat
        string instagramUsername
        string stravaUsername
        string websiteUrl
        string avatarFileId FK
        date creationDate
        int memberCount
    }
    CLUBS ||--o| AVATARS : "avatarFileId"

    REGISTRATIONS {
        string id PK
        string runId FK
        string userId FK
        date registrationDate
        string status
    }
    REGISTRATIONS ||--o| USERS : "userId"
    REGISTRATIONS ||--o| RUNS : "runId"

    RUNS {
        string id PK
        string name
        string difficulty
        string clubId FK
        date date
        string interval
        int intervalDay
        string startDescription
        string startTime
        decimal locationLng
        decimal locationLat
        decimal distance
        decimal temperature
        decimal wind
        decimal uv_index
        boolean membersOnly
    }
    RUNS ||--o| CLUBS : "clubId"

    AVATARS {
        string id PK
        string name
        string img_url
        date uploadDate
        avatarTypeEnum type
    }
```

### Database access

You can access the database locally through the following command:

```
 pnpm drizzle-kit studio
```

<!-- ROADMAP -->

## Roadmap

- [x] Setup database & API routes
- [x] Add club
- [x] Add recurring runs (on weekly basis)
- [x] Authentication (when adding a run or club, you'll be redirected to /api/auth/signin)
- [ ] Displaying runs a user has registered for on a profile page
- [ ] Combine Google Maps marker dragging and place search
- [ ] Add one time runs based on date
- [ ] Enhance club dashboard using roles
  - [ ] Page editing
  - [ ] Membership management
  - [ ] Registration management
- [ ] Open plattform for other sport types
- [ ] Implement weather API to forecast conditions for runs
- [ ] Implement Strava API to sync runs

<p align="right">(<a href="#readme-top">back to top</a>)</p>

<!-- CLEAN CODE EXAMPLES -->

# Clean Code examples

### API Documentation

As you can see in the [API documentation](http://localhost:3000/api-doc), I've used [Swagger](https://swagger.io/) to document my API.
I found it much more understandable than adding docstrings to routes.
This way it is also possible to test the routes using only this dashboard.

### Readability and Cleanliness

1. **DRY**
   To keep the code consistent, I used exported types and constants.
   The [types](./src/lib/types/) we're the most helpful ones, as I changed them often and it was easier to change them in one place.
2. **Code formatting**
   Enabling prettier on save in VSCode and enabling auto deletion for unused imports was a game changer for keeping the files clean.
3. **Naming**
   I renamed and moved files much more often than I was used to, to make sure that names were intention revealing.
4. **Refactoring**  
   When a feature was finished, I intended to refactor it as soon as possible. Complex components were broken into smaller ones and often refactored in one state and one UI component.
   This opens the possibility to use UI testing libraries like [Storybook JS](https://storybook.js.org/)
5. **Magic numbers**
   I used magic numbers or strings often in my last projects, but tried to avoid them and use constants or enums instead.

### Simplicity

This module really helped me understanding the value of clean code and how important it is to not clean it once, but to maintain it.
Especially avoiding overcomplex or too nested structures, to keep the code readable and understandable.

### Committing

Early into the process I recognized that naturally I was used to doing smaller commits. This is the reason why atomic commits came quite naturally and were easy to implement. I was familiar with using fix, chore and feat as commit prefixes. Using the [gitmoji commit guidelines](https://gitmoji.dev/) was a great way to keep the commit messages consistent. Although I like the consinstency it is too much work researching the right emoji for every commit. I'll therefore not use it in further projects.

## Refactoring Workflow

The branch "[refactoringExample](https://github.com/Joelheile/ClubHub/commits/refactoringExample/)" is an example of a refacotring workflow I implemented. I cherry picked the commit of a refactoring I did earlier and broke it further down using atomic commits.

### Testing

The tests I currently have are mostly integration tests for the two most important routes: runs and clubs.
These tests were crucial for refactoring and to make sure, that the API worked like intended.
It helped me to understand the value of automated testing. In the next weeks I will further enhance testing on more routes, implement more E2E tests, it they make sense and most importantly build unit tests.

<p align="right">(<a href="#readme-top">back to top</a>)</p>
<!-- STATIC CODE ANALYSIS -->

## Static Code Analysis

I use ESLint for static code analysis. Mostly running it before pulling my branch, it has helped me to catch bugs and errors before they get merged into the main branch.
It is also a great tool to stay consistent. For example having a consistent Image tag and not switching.

**You can run it using:**

```
pnpm run lint
```

<!-- LICENSE -->

## License

Distributed under the MIT License. See `LICENSE.txt` for more information.

<p align="right">(<a href="#readme-top">back to top</a>)</p>

<!-- CONTACT -->

## Contact

Joel Heil Escobar - [@instagram](https://instagram/joelheile) - joel.heil-escobar@code.berlin

Project Link: [https://github.com/Joelheile/ClubHub](https://github.com/Joelheile/ClubHub)

<p align="right">(<a href="#readme-top">back to top</a>)</p>

<!-- ACKNOWLEDGMENTS -->

## Acknowledgments

These are tools I used the most while developing:

- [ShadCN UI components](https://ui.shadcn.com/docs/components/)
- [Gitmoji commit guidelines](https://gitmoji.dev/)
- [Lucide Icons](https://lucide.dev/)

<p align="right">(<a href="#readme-top">back to top</a>)</p>

<!-- MARKDOWN LINKS & IMAGES -->
<!-- https://www.markdownguide.org/basic-syntax/#reference-style-links -->

[contributors-shield]: https://img.shields.io/github/contributors/Joelheile/ClubHub.svg?style=for-the-badge
[contributors-url]: https://github.com/Joelheile/ClubHub/graphs/contributors
[forks-shield]: https://img.shields.io/github/forks/Joelheile/ClubHub.svg?style=for-the-badge
[forks-url]: https://github.com/Joelheile/ClubHub/network/members
[stars-shield]: https://img.shields.io/github/stars/Joelheile/ClubHub.svg?style=for-the-badge
[stars-url]: https://github.com/Joelheile/ClubHub/stargazers
[issues-shield]: https://img.shields.io/github/issues/Joelheile/ClubHub.svg?style=for-the-badge
[issues-url]: https://github.com/Joelheile/ClubHub/issues
[license-shield]: https://img.shields.io/github/license/Joelheile/ClubHub.svg?style=for-the-badge
[license-url]: https://github.com/Joelheile/ClubHub/blob/master/LICENSE.txt
[linkedin-shield]: https://img.shields.io/badge/-LinkedIn-black.svg?style=for-the-badge&logo=linkedin&colorB=555
[linkedin-url]: https://linkedin.com/in/joel-heil-escobar
[product-screenshot]: images/screenshot.png
[Next.js]: https://img.shields.io/badge/next.js-000000?style=for-the-badge&logo=nextdotjs&logoColor=white
[Next-url]: https://nextjs.org/
[React.js]: https://img.shields.io/badge/React-20232A?style=for-the-badge&logo=react&logoColor=61DAFB
[React-url]: https://reactjs.org/
[TailwindCSS]: https://img.shields.io/badge/tailwindcss-000000?style=for-the-badge&logo=tailwindcss&logoColor=white
[TailwindCSS-url]: https://tailwindcss.com/
